<!DOCTYPE html>
<html>
<header>
	<title>
	Selfaware Monopoly Lobby
	</title>
</header>
<body>
<h1> Player:</h1>
<p>Name: <input type="text" id="playerNameText" value="Insert Name"><br></p>


<p><button onclick="enterGame()"><b>Enter Game</b></button></p>

<script>
function log(message) {
	console.log(message);
}

function getAPIRoot() {
	var url = window.location.href
	var arr = url.split("/")
	return arr[0] + "//" + arr[2]
}

function getLobbyURL() {
	return getAPIRoot() + "/lobby"
}

function getGameURL() {
	return getAPIRoot()+ "/game"
}

function getEnterGameMessage() {
	var obj = {"player": document.getElementById("playerNameText").value, "action":{"name":"enterGame"}}
	return JSON.stringify(obj)
}

function handleResponse(response) {
	log(response)
	window.location.replace(getGameURL() + '?playerName=' + document.getElementById("playerNameText").value)
}

function enterGame() {
	var url = getLobbyURL()
	var content = getEnterGameMessage()
	
	var xmlHttp = new XMLHttpRequest();
    xmlHttp.onreadystatechange = function() { 
        if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
            handleResponse(xmlHttp.responseText);
    }
    xmlHttp.open("POST", url, true); // true for asynchronous 
    xmlHttp.send(content);
}
</script>

</body>
</html>
